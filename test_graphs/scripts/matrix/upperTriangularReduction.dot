digraph G {
    INP [label="1. input B: Matrix, I: Matrix"]
    SET1 [label="2. rows, cols = Matrix.shape(B)"]
    SET2 [label="3. Bc = Matrix.copy(B)"]
    
    IF1 [label="4. if rows!=cols"]
    THROW [label="5. error 'invalid'"]

    FOR_EXT [label="6. for j=0:cols"]

    FOR_INN [label="7. for i=0..j"]
    IF2 [label="8. if i==j"]
    SET3 [label="9. cst=Bc_ii"]
    SET4 [label="10. I[i]=Vector.arrayDiv( I[i], cst )"]
    SET5 [label="11. Bc[i]=Vector.arrayDiv( Bc[i], cst )"]
    
    ELSE [label="12. else"]
    SET6 [label="13. I[i]=Vector.arraySub( mult(I[j], Bc[i][j]) )"]
    SET7 [label="14. Bc[i]=Vector.arraySub( mult(Bc[j], Bc[i][j]) )"]
    

    RET [label="15. return Bc, I"]

    INP -> SET1 -> SET2 -> IF1
    IF1 -> THROW [label="true"]
    IF1 -> FOR_EXT [label="FALSE"]
    THROW -> END

    FOR_EXT -> FOR_INN [label="in range"]
    FOR_EXT -> RET [label="not in range"]
    
    FOR_INN -> IF2 [label="in range"]
    FOR_INN -> FOR_EXT [label="not in range"]

    IF2 -> SET3 [label="true"]
    SET3 -> SET4 -> SET5 -> FOR_INN
    IF2 -> ELSE [label="false"]
    ELSE -> SET6 -> SET7 -> FOR_INN

    RET -> END
    
    
}